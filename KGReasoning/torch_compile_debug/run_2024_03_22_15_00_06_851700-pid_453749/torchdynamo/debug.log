Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_0 =====
 <eval_with_key>.0 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_0 <eval_with_key>.0 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_0 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_1 =====
 <eval_with_key>.45 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_1 <eval_with_key>.45 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_1 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_2 =====
 <eval_with_key>.61 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_2 <eval_with_key>.61 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_2 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_3 =====
 <eval_with_key>.77 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_3 <eval_with_key>.77 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_3 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_4 =====
 <eval_with_key>.93 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_4 <eval_with_key>.93 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_4 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_5 =====
 <eval_with_key>.109 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_5 <eval_with_key>.109 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_5 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_6 =====
 <eval_with_key>.125 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_6 <eval_with_key>.125 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_6 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/caohanghang/gitproject/KGReasoning/models.py:194
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 28 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL_FUNCTION 5 [UserMethodVariable(<function KGReasoning.forward_box at 0x7f90c512fac0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
421           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 ROT_THREE
              8 ROT_TWO
             10 STORE_FAST               6 (all_center_embeddings)
             12 STORE_FAST               7 (all_offset_embeddings)
             14 STORE_FAST               8 (all_idxs)

422          16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 BUILD_LIST               0
             22 ROT_THREE
             24 ROT_TWO
             26 STORE_FAST               9 (all_union_center_embeddings)
             28 STORE_FAST              10 (all_union_offset_embeddings)
             30 STORE_FAST              11 (all_union_idxs)

423          32 LOAD_FAST                4 (batch_queries_dict)
             34 GET_ITER
        >>   36 FOR_ITER                75 (to 188)
             38 STORE_FAST              12 (query_structure)

424          40 LOAD_CONST               1 ('u')
             42 LOAD_FAST                0 (self)
             44 LOAD_ATTR                0 (query_name_dict)
             46 LOAD_FAST               12 (query_structure)
             48 BINARY_SUBSCR
             50 CONTAINS_OP              0
             52 POP_JUMP_IF_FALSE       64 (to 128)

426          54 LOAD_FAST                0 (self)
             56 LOAD_METHOD              1 (embed_query_box)
             58 LOAD_FAST                0 (self)
             60 LOAD_METHOD              2 (transform_union_query)
             62 LOAD_FAST                4 (batch_queries_dict)
             64 LOAD_FAST               12 (query_structure)
             66 BINARY_SUBSCR

427          68 LOAD_FAST               12 (query_structure)

426          70 CALL_METHOD              2

428          72 LOAD_FAST                0 (self)
             74 LOAD_METHOD              3 (transform_union_structure)
             76 LOAD_FAST               12 (query_structure)
             78 CALL_METHOD              1

429          80 LOAD_CONST               2 (0)

426          82 CALL_METHOD              3

425          84 UNPACK_SEQUENCE          3
             86 STORE_FAST              13 (center_embedding)
             88 STORE_FAST              14 (offset_embedding)
             90 STORE_FAST              15 (_)

430          92 LOAD_FAST                9 (all_union_center_embeddings)
             94 LOAD_METHOD              4 (append)
             96 LOAD_FAST               13 (center_embedding)
             98 CALL_METHOD              1
            100 POP_TOP

431         102 LOAD_FAST               10 (all_union_offset_embeddings)
            104 LOAD_METHOD              4 (append)
            106 LOAD_FAST               14 (offset_embedding)
            108 CALL_METHOD              1
            110 POP_TOP

432         112 LOAD_FAST               11 (all_union_idxs)
            114 LOAD_METHOD              5 (extend)
            116 LOAD_FAST                5 (batch_idxs_dict)
            118 LOAD_FAST               12 (query_structure)
            120 BINARY_SUBSCR
            122 CALL_METHOD              1
            124 POP_TOP
            126 JUMP_ABSOLUTE           18 (to 36)

434     >>  128 LOAD_FAST                0 (self)
            130 LOAD_METHOD              1 (embed_query_box)
            132 LOAD_FAST                4 (batch_queries_dict)
            134 LOAD_FAST               12 (query_structure)
            136 BINARY_SUBSCR

435         138 LOAD_FAST               12 (query_structure)

436         140 LOAD_CONST               2 (0)

434         142 CALL_METHOD              3
            144 UNPACK_SEQUENCE          3
            146 STORE_FAST              13 (center_embedding)
            148 STORE_FAST              14 (offset_embedding)
            150 STORE_FAST              15 (_)

437         152 LOAD_FAST                6 (all_center_embeddings)
            154 LOAD_METHOD              4 (append)
            156 LOAD_FAST               13 (center_embedding)
            158 CALL_METHOD              1
            160 POP_TOP

438         162 LOAD_FAST                7 (all_offset_embeddings)
            164 LOAD_METHOD              4 (append)
            166 LOAD_FAST               14 (offset_embedding)
            168 CALL_METHOD              1
            170 POP_TOP

439         172 LOAD_FAST                8 (all_idxs)
            174 LOAD_METHOD              5 (extend)
            176 LOAD_FAST                5 (batch_idxs_dict)
            178 LOAD_FAST               12 (query_structure)
            180 BINARY_SUBSCR
            182 CALL_METHOD              1
            184 POP_TOP
            186 JUMP_ABSOLUTE           18 (to 36)

441     >>  188 LOAD_GLOBAL              6 (len)
            190 LOAD_FAST                6 (all_center_embeddings)
            192 CALL_FUNCTION            1
            194 LOAD_CONST               2 (0)
            196 COMPARE_OP               4 (>)
            198 POP_JUMP_IF_FALSE      126 (to 252)
            200 LOAD_GLOBAL              6 (len)
            202 LOAD_FAST                7 (all_offset_embeddings)
            204 CALL_FUNCTION            1
            206 LOAD_CONST               2 (0)
            208 COMPARE_OP               4 (>)
            210 POP_JUMP_IF_FALSE      126 (to 252)

442         212 LOAD_GLOBAL              7 (torch)
            214 LOAD_ATTR                8 (cat)
            216 LOAD_FAST                6 (all_center_embeddings)
            218 LOAD_CONST               2 (0)
            220 LOAD_CONST               3 (('dim',))
            222 CALL_FUNCTION_KW         2
            224 LOAD_METHOD              9 (unsqueeze)
            226 LOAD_CONST               4 (1)
            228 CALL_METHOD              1
            230 STORE_FAST               6 (all_center_embeddings)

443         232 LOAD_GLOBAL              7 (torch)
            234 LOAD_ATTR                8 (cat)
            236 LOAD_FAST                7 (all_offset_embeddings)
            238 LOAD_CONST               2 (0)
            240 LOAD_CONST               3 (('dim',))
            242 CALL_FUNCTION_KW         2
            244 LOAD_METHOD              9 (unsqueeze)
            246 LOAD_CONST               4 (1)
            248 CALL_METHOD              1
            250 STORE_FAST               7 (all_offset_embeddings)

444     >>  252 LOAD_GLOBAL              6 (len)
            254 LOAD_FAST                9 (all_union_center_embeddings)
            256 CALL_FUNCTION            1
            258 LOAD_CONST               2 (0)
            260 COMPARE_OP               4 (>)
            262 POP_JUMP_IF_FALSE      184 (to 368)
            264 LOAD_GLOBAL              6 (len)
            266 LOAD_FAST               10 (all_union_offset_embeddings)
            268 CALL_FUNCTION            1
            270 LOAD_CONST               2 (0)
            272 COMPARE_OP               4 (>)
            274 POP_JUMP_IF_FALSE      184 (to 368)

445         276 LOAD_GLOBAL              7 (torch)
            278 LOAD_ATTR                8 (cat)
            280 LOAD_FAST                9 (all_union_center_embeddings)
            282 LOAD_CONST               2 (0)
            284 LOAD_CONST               3 (('dim',))
            286 CALL_FUNCTION_KW         2
            288 LOAD_METHOD              9 (unsqueeze)
            290 LOAD_CONST               4 (1)
            292 CALL_METHOD              1
            294 STORE_FAST               9 (all_union_center_embeddings)

446         296 LOAD_GLOBAL              7 (torch)
            298 LOAD_ATTR                8 (cat)
            300 LOAD_FAST               10 (all_union_offset_embeddings)
            302 LOAD_CONST               2 (0)
            304 LOAD_CONST               3 (('dim',))
            306 CALL_FUNCTION_KW         2
            308 LOAD_METHOD              9 (unsqueeze)
            310 LOAD_CONST               4 (1)
            312 CALL_METHOD              1
            314 STORE_FAST              10 (all_union_offset_embeddings)

447         316 LOAD_FAST                9 (all_union_center_embeddings)
            318 LOAD_METHOD             10 (view)
            320 LOAD_FAST                9 (all_union_center_embeddings)
            322 LOAD_ATTR               11 (shape)
            324 LOAD_CONST               2 (0)
            326 BINARY_SUBSCR
            328 LOAD_CONST               5 (2)
            330 BINARY_FLOOR_DIVIDE
            332 LOAD_CONST               5 (2)
            334 LOAD_CONST               4 (1)
            336 LOAD_CONST               6 (-1)
            338 CALL_METHOD              4
            340 STORE_FAST               9 (all_union_center_embeddings)

448         342 LOAD_FAST               10 (all_union_offset_embeddings)
            344 LOAD_METHOD             10 (view)
            346 LOAD_FAST               10 (all_union_offset_embeddings)
            348 LOAD_ATTR               11 (shape)
            350 LOAD_CONST               2 (0)
            352 BINARY_SUBSCR
            354 LOAD_CONST               5 (2)
            356 BINARY_FLOOR_DIVIDE
            358 LOAD_CONST               5 (2)
            360 LOAD_CONST               4 (1)
            362 LOAD_CONST               6 (-1)
            364 CALL_METHOD              4
            366 STORE_FAST              10 (all_union_offset_embeddings)

450     >>  368 LOAD_GLOBAL             12 (type)
            370 LOAD_FAST                3 (subsampling_weight)
            372 CALL_FUNCTION            1
            374 LOAD_GLOBAL             12 (type)
            376 LOAD_CONST               0 (None)
            378 CALL_FUNCTION            1
            380 COMPARE_OP               3 (!=)
            382 POP_JUMP_IF_FALSE      198 (to 396)

451         384 LOAD_FAST                3 (subsampling_weight)
            386 LOAD_FAST                8 (all_idxs)
            388 LOAD_FAST               11 (all_union_idxs)
            390 BINARY_ADD
            392 BINARY_SUBSCR
            394 STORE_FAST               3 (subsampling_weight)

453     >>  396 LOAD_GLOBAL             12 (type)
            398 LOAD_FAST                1 (positive_sample)
            400 CALL_FUNCTION            1
            402 LOAD_GLOBAL             12 (type)
            404 LOAD_CONST               0 (None)
            406 CALL_FUNCTION            1
            408 COMPARE_OP               3 (!=)
            410 EXTENDED_ARG             1
            412 POP_JUMP_IF_FALSE      310 (to 620)

454         414 LOAD_GLOBAL              6 (len)
            416 LOAD_FAST                6 (all_center_embeddings)
            418 CALL_FUNCTION            1
            420 LOAD_CONST               2 (0)
            422 COMPARE_OP               4 (>)
            424 POP_JUMP_IF_FALSE      237 (to 474)

455         426 LOAD_FAST                1 (positive_sample)
            428 LOAD_FAST                8 (all_idxs)
            430 BINARY_SUBSCR
            432 STORE_FAST              16 (positive_sample_regular)

456         434 LOAD_GLOBAL              7 (torch)
            436 LOAD_ATTR               13 (index_select)
            438 LOAD_FAST                0 (self)
            440 LOAD_ATTR               14 (entity_embedding)
            442 LOAD_CONST               2 (0)
            444 LOAD_FAST               16 (positive_sample_regular)
            446 LOAD_CONST               7 (('dim', 'index'))
            448 CALL_FUNCTION_KW         3
            450 LOAD_METHOD              9 (unsqueeze)
            452 LOAD_CONST               4 (1)
            454 CALL_METHOD              1
            456 STORE_FAST              17 (positive_embedding)

457         458 LOAD_FAST                0 (self)
            460 LOAD_METHOD             15 (cal_logit_box)
            462 LOAD_FAST               17 (positive_embedding)
            464 LOAD_FAST                6 (all_center_embeddings)
            466 LOAD_FAST                7 (all_offset_embeddings)
            468 CALL_METHOD              3
            470 STORE_FAST              18 (positive_logit)
            472 JUMP_FORWARD            10 (to 494)

459     >>  474 LOAD_GLOBAL              7 (torch)
            476 LOAD_METHOD             16 (Tensor)
            478 BUILD_LIST               0
            480 CALL_METHOD              1
            482 LOAD_METHOD             17 (to)
            484 LOAD_FAST                0 (self)
            486 LOAD_ATTR               14 (entity_embedding)
            488 LOAD_ATTR               18 (device)
            490 CALL_METHOD              1
            492 STORE_FAST              18 (positive_logit)

461     >>  494 LOAD_GLOBAL              6 (len)
            496 LOAD_FAST                9 (all_union_center_embeddings)
            498 CALL_FUNCTION            1
            500 LOAD_CONST               2 (0)
            502 COMPARE_OP               4 (>)
            504 EXTENDED_ARG             1
            506 POP_JUMP_IF_FALSE      290 (to 580)

462         508 LOAD_FAST                1 (positive_sample)
            510 LOAD_FAST               11 (all_union_idxs)
            512 BINARY_SUBSCR
            514 STORE_FAST              19 (positive_sample_union)

463         516 LOAD_GLOBAL              7 (torch)
            518 LOAD_ATTR               13 (index_select)
            520 LOAD_FAST                0 (self)
            522 LOAD_ATTR               14 (entity_embedding)
            524 LOAD_CONST               2 (0)
            526 LOAD_FAST               19 (positive_sample_union)
            528 LOAD_CONST               7 (('dim', 'index'))
            530 CALL_FUNCTION_KW         3
            532 LOAD_METHOD              9 (unsqueeze)
            534 LOAD_CONST               4 (1)
            536 CALL_METHOD              1
            538 LOAD_METHOD              9 (unsqueeze)
            540 LOAD_CONST               4 (1)
            542 CALL_METHOD              1
            544 STORE_FAST              17 (positive_embedding)

464         546 LOAD_FAST                0 (self)
            548 LOAD_METHOD             15 (cal_logit_box)
            550 LOAD_FAST               17 (positive_embedding)
            552 LOAD_FAST                9 (all_union_center_embeddings)
            554 LOAD_FAST               10 (all_union_offset_embeddings)
            556 CALL_METHOD              3
            558 STORE_FAST              20 (positive_union_logit)

465         560 LOAD_GLOBAL              7 (torch)
            562 LOAD_ATTR               19 (max)
            564 LOAD_FAST               20 (positive_union_logit)
            566 LOAD_CONST               4 (1)
            568 LOAD_CONST               3 (('dim',))
            570 CALL_FUNCTION_KW         2
            572 LOAD_CONST               2 (0)
            574 BINARY_SUBSCR
            576 STORE_FAST              20 (positive_union_logit)
            578 JUMP_FORWARD            10 (to 600)

467     >>  580 LOAD_GLOBAL              7 (torch)
            582 LOAD_METHOD             16 (Tensor)
            584 BUILD_LIST               0
            586 CALL_METHOD              1
            588 LOAD_METHOD             17 (to)
            590 LOAD_FAST                0 (self)
            592 LOAD_ATTR               14 (entity_embedding)
            594 LOAD_ATTR               18 (device)
            596 CALL_METHOD              1
            598 STORE_FAST              20 (positive_union_logit)

468     >>  600 LOAD_GLOBAL              7 (torch)
            602 LOAD_ATTR                8 (cat)
            604 LOAD_FAST               18 (positive_logit)
            606 LOAD_FAST               20 (positive_union_logit)
            608 BUILD_LIST               2
            610 LOAD_CONST               2 (0)
            612 LOAD_CONST               3 (('dim',))
            614 CALL_FUNCTION_KW         2
            616 STORE_FAST              18 (positive_logit)
            618 JUMP_FORWARD             2 (to 624)

470     >>  620 LOAD_CONST               0 (None)
            622 STORE_FAST              18 (positive_logit)

472     >>  624 LOAD_GLOBAL             12 (type)
            626 LOAD_FAST                2 (negative_sample)
            628 CALL_FUNCTION            1
            630 LOAD_GLOBAL             12 (type)
            632 LOAD_CONST               0 (None)
            634 CALL_FUNCTION            1
            636 COMPARE_OP               3 (!=)
            638 EXTENDED_ARG             1
            640 POP_JUMP_IF_FALSE      443 (to 886)

473         642 LOAD_GLOBAL              6 (len)
            644 LOAD_FAST                6 (all_center_embeddings)
            646 CALL_FUNCTION            1
            648 LOAD_CONST               2 (0)
            650 COMPARE_OP               4 (>)
            652 EXTENDED_ARG             1
            654 POP_JUMP_IF_FALSE      362 (to 724)

474         656 LOAD_FAST                2 (negative_sample)
            658 LOAD_FAST                8 (all_idxs)
            660 BINARY_SUBSCR
            662 STORE_FAST              21 (negative_sample_regular)

475         664 LOAD_FAST               21 (negative_sample_regular)
            666 LOAD_ATTR               11 (shape)
            668 UNPACK_SEQUENCE          2
            670 STORE_FAST              22 (batch_size)
            672 STORE_FAST              23 (negative_size)

476         674 LOAD_GLOBAL              7 (torch)
            676 LOAD_ATTR               13 (index_select)
            678 LOAD_FAST                0 (self)
            680 LOAD_ATTR               14 (entity_embedding)
            682 LOAD_CONST               2 (0)
            684 LOAD_FAST               21 (negative_sample_regular)
            686 LOAD_METHOD             10 (view)
            688 LOAD_CONST               6 (-1)
            690 CALL_METHOD              1
            692 LOAD_CONST               7 (('dim', 'index'))
            694 CALL_FUNCTION_KW         3
            696 LOAD_METHOD             10 (view)
            698 LOAD_FAST               22 (batch_size)
            700 LOAD_FAST               23 (negative_size)
            702 LOAD_CONST               6 (-1)
            704 CALL_METHOD              3
            706 STORE_FAST              24 (negative_embedding)

477         708 LOAD_FAST                0 (self)
            710 LOAD_METHOD             15 (cal_logit_box)
            712 LOAD_FAST               24 (negative_embedding)
            714 LOAD_FAST                6 (all_center_embeddings)
            716 LOAD_FAST                7 (all_offset_embeddings)
            718 CALL_METHOD              3
            720 STORE_FAST              25 (negative_logit)
            722 JUMP_FORWARD            10 (to 744)

479     >>  724 LOAD_GLOBAL              7 (torch)
            726 LOAD_METHOD             16 (Tensor)
            728 BUILD_LIST               0
            730 CALL_METHOD              1
            732 LOAD_METHOD             17 (to)
            734 LOAD_FAST                0 (self)
            736 LOAD_ATTR               14 (entity_embedding)
            738 LOAD_ATTR               18 (device)
            740 CALL_METHOD              1
            742 STORE_FAST              25 (negative_logit)

481     >>  744 LOAD_GLOBAL              6 (len)
            746 LOAD_FAST                9 (all_union_center_embeddings)
            748 CALL_FUNCTION            1
            750 LOAD_CONST               2 (0)
            752 COMPARE_OP               4 (>)
            754 EXTENDED_ARG             1
            756 POP_JUMP_IF_FALSE      423 (to 846)

482         758 LOAD_FAST                2 (negative_sample)
            760 LOAD_FAST               11 (all_union_idxs)
            762 BINARY_SUBSCR
            764 STORE_FAST              26 (negative_sample_union)

483         766 LOAD_FAST               26 (negative_sample_union)
            768 LOAD_ATTR               11 (shape)
            770 UNPACK_SEQUENCE          2
            772 STORE_FAST              22 (batch_size)
            774 STORE_FAST              23 (negative_size)

484         776 LOAD_GLOBAL              7 (torch)
            778 LOAD_ATTR               13 (index_select)
            780 LOAD_FAST                0 (self)
            782 LOAD_ATTR               14 (entity_embedding)
            784 LOAD_CONST               2 (0)
            786 LOAD_FAST               26 (negative_sample_union)
            788 LOAD_METHOD             10 (view)
            790 LOAD_CONST               6 (-1)
            792 CALL_METHOD              1
            794 LOAD_CONST               7 (('dim', 'index'))
            796 CALL_FUNCTION_KW         3
            798 LOAD_METHOD             10 (view)
            800 LOAD_FAST               22 (batch_size)
            802 LOAD_CONST               4 (1)
            804 LOAD_FAST               23 (negative_size)
            806 LOAD_CONST               6 (-1)
            808 CALL_METHOD              4
            810 STORE_FAST              24 (negative_embedding)

485         812 LOAD_FAST                0 (self)
            814 LOAD_METHOD             15 (cal_logit_box)
            816 LOAD_FAST               24 (negative_embedding)
            818 LOAD_FAST                9 (all_union_center_embeddings)
            820 LOAD_FAST               10 (all_union_offset_embeddings)
            822 CALL_METHOD              3
            824 STORE_FAST              27 (negative_union_logit)

486         826 LOAD_GLOBAL              7 (torch)
            828 LOAD_ATTR               19 (max)
            830 LOAD_FAST               27 (negative_union_logit)
            832 LOAD_CONST               4 (1)
            834 LOAD_CONST               3 (('dim',))
            836 CALL_FUNCTION_KW         2
            838 LOAD_CONST               2 (0)
            840 BINARY_SUBSCR
            842 STORE_FAST              27 (negative_union_logit)
            844 JUMP_FORWARD            10 (to 866)

488     >>  846 LOAD_GLOBAL              7 (torch)
            848 LOAD_METHOD             16 (Tensor)
            850 BUILD_LIST               0
            852 CALL_METHOD              1
            854 LOAD_METHOD             17 (to)
            856 LOAD_FAST                0 (self)
            858 LOAD_ATTR               14 (entity_embedding)
            860 LOAD_ATTR               18 (device)
            862 CALL_METHOD              1
            864 STORE_FAST              27 (negative_union_logit)

489     >>  866 LOAD_GLOBAL              7 (torch)
            868 LOAD_ATTR                8 (cat)
            870 LOAD_FAST               25 (negative_logit)
            872 LOAD_FAST               27 (negative_union_logit)
            874 BUILD_LIST               2
            876 LOAD_CONST               2 (0)
            878 LOAD_CONST               3 (('dim',))
            880 CALL_FUNCTION_KW         2
            882 STORE_FAST              25 (negative_logit)
            884 JUMP_FORWARD             2 (to 890)

491     >>  886 LOAD_CONST               0 (None)
            888 STORE_FAST              25 (negative_logit)

493     >>  890 LOAD_FAST               18 (positive_logit)
            892 LOAD_FAST               25 (negative_logit)
            894 LOAD_FAST                3 (subsampling_weight)
            896 LOAD_FAST                8 (all_idxs)
            898 LOAD_FAST               11 (all_union_idxs)
            900 BINARY_ADD
            902 BUILD_TUPLE              4
            904 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7f90c5134a80, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_7 =====
 <eval_with_key>.141 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_7 <eval_with_key>.141 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_7 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_8 =====
 <eval_with_key>.157 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_8 <eval_with_key>.157 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_8 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_9 =====
 <eval_with_key>.173 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_9 <eval_with_key>.173 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_9 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_10 =====
 <eval_with_key>.189 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_10 <eval_with_key>.189 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_10 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_11 =====
 <eval_with_key>.205 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_11 <eval_with_key>.205 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_11 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_12 =====
 <eval_with_key>.221 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_12 <eval_with_key>.221 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_12 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_13 =====
 <eval_with_key>.237 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_13 <eval_with_key>.237 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_13 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_14 =====
 <eval_with_key>.253 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_14 <eval_with_key>.253 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_14 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/caohanghang/gitproject/KGReasoning/models.py:420
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE ROT_THREE None [ListVariable(), ListVariable(), ListVariable()]
TRACE ROT_TWO None [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_IF_FALSE 128 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE CALL_FUNCTION 3 [ListIteratorVariable([TupleVariable()], index=1), UserMethodVariable(<function KGReasoning.embed_query_box at 0x7f90c512f640>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
207           0 LOAD_CONST               1 (True)
              2 STORE_FAST               4 (all_relation_flag)

208           4 LOAD_FAST                2 (query_structure)
              6 LOAD_CONST               2 (-1)
              8 BINARY_SUBSCR
             10 GET_ITER
        >>   12 FOR_ITER                10 (to 34)
             14 STORE_FAST               5 (ele)

209          16 LOAD_FAST                5 (ele)
             18 LOAD_CONST               3 (('r', 'n'))
             20 CONTAINS_OP              1
             22 POP_JUMP_IF_FALSE       16 (to 32)

210          24 LOAD_CONST               4 (False)
             26 STORE_FAST               4 (all_relation_flag)

211          28 POP_TOP
             30 JUMP_FORWARD             1 (to 34)

209     >>   32 JUMP_ABSOLUTE            6 (to 12)

212     >>   34 LOAD_FAST                4 (all_relation_flag)
             36 POP_JUMP_IF_FALSE      142 (to 284)

213          38 LOAD_FAST                2 (query_structure)
             40 LOAD_CONST               5 (0)
             42 BINARY_SUBSCR
             44 LOAD_CONST               6 ('e')
             46 COMPARE_OP               2 (==)
             48 POP_JUMP_IF_FALSE       61 (to 122)

214          50 LOAD_GLOBAL              0 (torch)
             52 LOAD_ATTR                1 (index_select)
             54 LOAD_FAST                0 (self)
             56 LOAD_ATTR                2 (entity_embedding)
             58 LOAD_CONST               5 (0)
             60 LOAD_FAST                1 (queries)
             62 LOAD_CONST               7 (None)
             64 LOAD_CONST               7 (None)
             66 BUILD_SLICE              2
             68 LOAD_FAST                3 (idx)
             70 BUILD_TUPLE              2
             72 BINARY_SUBSCR
             74 LOAD_CONST               8 (('dim', 'index'))
             76 CALL_FUNCTION_KW         3
             78 STORE_FAST               6 (embedding)

215          80 LOAD_FAST                0 (self)
             82 LOAD_ATTR                3 (use_cuda)
             84 POP_JUMP_IF_FALSE       51 (to 102)

216          86 LOAD_GLOBAL              0 (torch)
             88 LOAD_METHOD              4 (zeros_like)
             90 LOAD_FAST                6 (embedding)
             92 CALL_METHOD              1
             94 LOAD_METHOD              5 (cuda)
             96 CALL_METHOD              0
             98 STORE_FAST               7 (offset_embedding)
            100 JUMP_FORWARD             5 (to 112)

218     >>  102 LOAD_GLOBAL              0 (torch)
            104 LOAD_METHOD              4 (zeros_like)
            106 LOAD_FAST                6 (embedding)
            108 CALL_METHOD              1
            110 STORE_FAST               7 (offset_embedding)

219     >>  112 LOAD_FAST                3 (idx)
            114 LOAD_CONST               9 (1)
            116 INPLACE_ADD
            118 STORE_FAST               3 (idx)
            120 JUMP_FORWARD            12 (to 146)

221     >>  122 LOAD_FAST                0 (self)
            124 LOAD_METHOD              6 (embed_query_box)
            126 LOAD_FAST                1 (queries)
            128 LOAD_FAST                2 (query_structure)
            130 LOAD_CONST               5 (0)
            132 BINARY_SUBSCR
            134 LOAD_FAST                3 (idx)
            136 CALL_METHOD              3
            138 UNPACK_SEQUENCE          3
            140 STORE_FAST               6 (embedding)
            142 STORE_FAST               7 (offset_embedding)
            144 STORE_FAST               3 (idx)

222     >>  146 LOAD_GLOBAL              7 (range)
            148 LOAD_GLOBAL              8 (len)
            150 LOAD_FAST                2 (query_structure)
            152 LOAD_CONST               2 (-1)
            154 BINARY_SUBSCR
            156 CALL_FUNCTION            1
            158 CALL_FUNCTION            1
            160 GET_ITER
        >>  162 FOR_ITER                59 (to 282)
            164 STORE_FAST               8 (i)

223         166 LOAD_FAST                2 (query_structure)
            168 LOAD_CONST               2 (-1)
            170 BINARY_SUBSCR
            172 LOAD_FAST                8 (i)
            174 BINARY_SUBSCR
            176 LOAD_CONST              10 ('n')
            178 COMPARE_OP               2 (==)
            180 POP_JUMP_IF_FALSE       95 (to 190)

224         182 LOAD_ASSERTION_ERROR
            184 LOAD_CONST              11 ('box cannot handle queries with negation')
            186 CALL_FUNCTION            1
            188 RAISE_VARARGS            1

226     >>  190 LOAD_GLOBAL              0 (torch)
            192 LOAD_ATTR                1 (index_select)
            194 LOAD_FAST                0 (self)
            196 LOAD_ATTR                9 (relation_embedding)
            198 LOAD_CONST               5 (0)
            200 LOAD_FAST                1 (queries)
            202 LOAD_CONST               7 (None)
            204 LOAD_CONST               7 (None)
            206 BUILD_SLICE              2
            208 LOAD_FAST                3 (idx)
            210 BUILD_TUPLE              2
            212 BINARY_SUBSCR
            214 LOAD_CONST               8 (('dim', 'index'))
            216 CALL_FUNCTION_KW         3
            218 STORE_FAST               9 (r_embedding)

227         220 LOAD_GLOBAL              0 (torch)
            222 LOAD_ATTR                1 (index_select)
            224 LOAD_FAST                0 (self)
            226 LOAD_ATTR               10 (offset_embedding)
            228 LOAD_CONST               5 (0)
            230 LOAD_FAST                1 (queries)
            232 LOAD_CONST               7 (None)
            234 LOAD_CONST               7 (None)
            236 BUILD_SLICE              2
            238 LOAD_FAST                3 (idx)
            240 BUILD_TUPLE              2
            242 BINARY_SUBSCR
            244 LOAD_CONST               8 (('dim', 'index'))
            246 CALL_FUNCTION_KW         3
            248 STORE_FAST              10 (r_offset_embedding)

228         250 LOAD_FAST                6 (embedding)
            252 LOAD_FAST                9 (r_embedding)
            254 INPLACE_ADD
            256 STORE_FAST               6 (embedding)

229         258 LOAD_FAST                7 (offset_embedding)
            260 LOAD_FAST                0 (self)
            262 LOAD_METHOD             11 (func)
            264 LOAD_FAST               10 (r_offset_embedding)
            266 CALL_METHOD              1
            268 INPLACE_ADD
            270 STORE_FAST               7 (offset_embedding)

230         272 LOAD_FAST                3 (idx)
            274 LOAD_CONST               9 (1)
            276 INPLACE_ADD
            278 STORE_FAST               3 (idx)
            280 JUMP_ABSOLUTE           81 (to 162)

222     >>  282 JUMP_FORWARD            51 (to 386)

232     >>  284 BUILD_LIST               0
            286 STORE_FAST              11 (embedding_list)

233         288 BUILD_LIST               0
            290 STORE_FAST              12 (offset_embedding_list)

234         292 LOAD_GLOBAL              7 (range)
            294 LOAD_GLOBAL              8 (len)
            296 LOAD_FAST                2 (query_structure)
            298 CALL_FUNCTION            1
            300 CALL_FUNCTION            1
            302 GET_ITER
        >>  304 FOR_ITER                24 (to 354)
            306 STORE_FAST               8 (i)

235         308 LOAD_FAST                0 (self)
            310 LOAD_METHOD              6 (embed_query_box)
            312 LOAD_FAST                1 (queries)
            314 LOAD_FAST                2 (query_structure)
            316 LOAD_FAST                8 (i)
            318 BINARY_SUBSCR
            320 LOAD_FAST                3 (idx)
            322 CALL_METHOD              3
            324 UNPACK_SEQUENCE          3
            326 STORE_FAST               6 (embedding)
            328 STORE_FAST               7 (offset_embedding)
            330 STORE_FAST               3 (idx)

236         332 LOAD_FAST               11 (embedding_list)
            334 LOAD_METHOD             12 (append)
            336 LOAD_FAST                6 (embedding)
            338 CALL_METHOD              1
            340 POP_TOP

237         342 LOAD_FAST               12 (offset_embedding_list)
            344 LOAD_METHOD             12 (append)
            346 LOAD_FAST                7 (offset_embedding)
            348 CALL_METHOD              1
            350 POP_TOP
            352 JUMP_ABSOLUTE          152 (to 304)

238     >>  354 LOAD_FAST                0 (self)
            356 LOAD_METHOD             13 (center_net)
            358 LOAD_GLOBAL              0 (torch)
            360 LOAD_METHOD             14 (stack)
            362 LOAD_FAST               11 (embedding_list)
            364 CALL_METHOD              1
            366 CALL_METHOD              1
            368 STORE_FAST               6 (embedding)

239         370 LOAD_FAST                0 (self)
            372 LOAD_METHOD             15 (offset_net)
            374 LOAD_GLOBAL              0 (torch)
            376 LOAD_METHOD             14 (stack)
            378 LOAD_FAST               12 (offset_embedding_list)
            380 CALL_METHOD              1
            382 CALL_METHOD              1
            384 STORE_FAST               7 (offset_embedding)

241     >>  386 LOAD_FAST                6 (embedding)
            388 LOAD_FAST                7 (offset_embedding)
            390 LOAD_FAST                3 (idx)
            392 BUILD_TUPLE              3
            394 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE INPLACE_ADD None [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x7f90c5134450, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append)]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_ATTR extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([TupleVariable()], index=1), GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_ABSOLUTE 36 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 188 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 252 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 368 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 396 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [SkipFilesVariable(), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 620 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_IF_FALSE 886 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 724 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_ATTR view [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST batch_size [GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION 3 [GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 3 [UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7f90c512fa30>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
414           0 LOAD_FAST                1 (entity_embedding)
              2 LOAD_FAST                2 (query_center_embedding)
              4 BINARY_SUBTRACT
              6 LOAD_METHOD              0 (abs)
              8 CALL_METHOD              0
             10 STORE_FAST               4 (delta)

415          12 LOAD_GLOBAL              1 (F)
             14 LOAD_METHOD              2 (relu)
             16 LOAD_FAST                4 (delta)
             18 LOAD_FAST                3 (query_offset_embedding)
             20 BINARY_SUBTRACT
             22 CALL_METHOD              1
             24 STORE_FAST               5 (distance_out)

416          26 LOAD_GLOBAL              3 (torch)
             28 LOAD_METHOD              4 (min)
             30 LOAD_FAST                4 (delta)
             32 LOAD_FAST                3 (query_offset_embedding)
             34 CALL_METHOD              2
             36 STORE_FAST               6 (distance_in)

417          38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                5 (gamma)
             42 LOAD_GLOBAL              3 (torch)
             44 LOAD_ATTR                6 (norm)
             46 LOAD_FAST                5 (distance_out)
             48 LOAD_CONST               1 (1)
             50 LOAD_CONST               2 (-1)
             52 LOAD_CONST               3 (('p', 'dim'))
             54 CALL_FUNCTION_KW         3
             56 BINARY_SUBTRACT
             58 LOAD_FAST                0 (self)
             60 LOAD_ATTR                7 (cen)
             62 LOAD_GLOBAL              3 (torch)
             64 LOAD_ATTR                6 (norm)
             66 LOAD_FAST                6 (distance_in)
             68 LOAD_CONST               1 (1)
             70 LOAD_CONST               2 (-1)
             72 LOAD_CONST               3 (('p', 'dim'))
             74 CALL_FUNCTION_KW         3
             76 BINARY_MULTIPLY
             78 BINARY_SUBTRACT
             80 STORE_FAST               7 (logit)

418          82 LOAD_FAST                7 (logit)
             84 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), TensorVariable()]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7f90c51349d0, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 744 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [BuiltinVariable(len)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_IF_FALSE 846 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [TorchVariable(<class 'torch.Tensor'>)]
TRACE CALL_FUNCTION 1 [TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST self [GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL_FUNCTION 1 [GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>)]
TRACE LOAD_FAST negative_union_logit [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable()]
TRACE BUILD_LIST 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable()]
TRACE LOAD_CONST ('dim',) [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 2 [TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7f9168185840>), ListVariable(), ConstantVariable(int), TupleVariable()]
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 890 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_ADD None [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_15 =====
 <eval_with_key>.269 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_15 <eval_with_key>.269 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7f9168185840>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7f9168185840>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7f90c67555a0>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7f9168185840>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7f90c655b910>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7f90c655b910>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7f9168185840>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_15 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/caohanghang/gitproject/KGReasoning/models.py:202
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_IF_FALSE 32 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_ABSOLUTE 12 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 34 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_IF_FALSE 284 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 122 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR entity_embedding [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), LazyVariableTracker()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST ('dim', 'index') [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_IF_FALSE 102 [ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>)]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_ATTR cuda [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), cuda)]
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 112 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE INPLACE_ADD None [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 146 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [BuiltinVariable(range), BuiltinVariable(len)]
TRACE LOAD_CONST -1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [BuiltinVariable(range), BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), BuiltinVariable(len), TupleVariable()]
TRACE CALL_FUNCTION 1 [BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_IF_FALSE 190 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE LOAD_CONST ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL_FUNCTION_KW 3 [ListIteratorVariable([ConstantVariable(int)], index=1), TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7f9168185840>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_ATTR func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable()]
TRACE CALL_FUNCTION 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), UserFunctionVariable(), TensorVariable()]
INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
 24           0 LOAD_FAST                0 (x)
              2 RETURN_VALUE
, inlined by default
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7f90c5123520, file "/home/caohanghang/gitproject/KGReasoning/models.py", line 23>
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE INPLACE_ADD None [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_ABSOLUTE 162 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 282 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 386 []
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_16 =====
 <eval_with_key>.285 class GraphModule(torch.nn.Module):
    def forward(self, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  l__self___entity_embedding = getitem = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)];  l_queries_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_1 = embedding;  embedding = r_embedding = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_1 = offset_embedding;  offset_embedding = r_offset_embedding = None
        return (embedding_1, offset_embedding_1)
        

TRACED GRAPH
 __compiled_fn_16 <eval_with_key>.285 opcode         name                          target                                                           args                                        kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ------------------------------------------  ------------------------------
placeholder    l_queries_                    L_queries_                                                       ()                                          {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                          {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7f9168185840>  (l__self___entity_embedding,)               {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7f9168185840>    (embedding,)                                {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                               {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                          {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7f9168185840>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                          {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7f9168185840>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_2}
call_function  embedding_1                   <built-in function iadd>                                         (embedding, r_embedding)                    {}
call_function  offset_embedding_1            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)      {}
output         output                        output                                                           ((embedding_1, offset_embedding_1),)        {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_16 =====
l_queries_: (1, 2)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_1: (1, 400)
offset_embedding_1: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing cal_logit_box /home/caohanghang/gitproject/KGReasoning/models.py:413
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [LazyVariableTracker()]
TRACE BINARY_SUBTRACT None [LazyVariableTracker(), LazyVariableTracker()]
create_graph_input L_entity_embedding_ L['entity_embedding']
wrap_to_fake L['entity_embedding'] (1, 14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None, None]
create_graph_input L_query_center_embedding_ L['query_center_embedding']
wrap_to_fake L['query_center_embedding'] (1, 1, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None, None]
TRACE LOAD_ATTR abs [TensorVariable()]
TRACE CALL_FUNCTION 0 [GetAttrVariable(TensorVariable(), abs)]
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [TorchVariable(<module 'torch.nn.functional' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE BINARY_SUBTRACT None [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable(), LazyVariableTracker()]
create_graph_input L_query_offset_embedding_ L['query_offset_embedding']
wrap_to_fake L['query_offset_embedding'] (1, 1, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None, None]
TRACE CALL_FUNCTION 1 [TorchInGraphFunctionVariable(<function relu at 0x7f90c67555a0>), TensorVariable()]
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>)]
TRACE LOAD_FAST query_offset_embedding [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable()]
TRACE CALL_FUNCTION 2 [TorchInGraphFunctionVariable(<built-in method min of type object at 0x7f9168185840>), TensorVariable(), TensorVariable()]
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [LazyVariableTracker()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), TorchVariable(<module 'torch' from '/home/caohanghang/miniconda3/envs/KGN/lib/python3.10/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST ('p', 'dim') [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL_FUNCTION_KW 3 [TensorVariable(), ConstantVariable(float), TorchInGraphFunctionVariable(<function norm at 0x7f90c655b910>), TensorVariable(), ConstantVariable(int), ConstantVariable(int), TupleVariable()]
TRACE BINARY_MULTIPLY None [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE BINARY_SUBTRACT None [TensorVariable(), TensorVariable()]
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/caohanghang/gitproject/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing cal_logit_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/caohanghang/gitproject/KGReasoning/models.py, line 418 in cal_logit_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_17 =====
 <eval_with_key>.296 class GraphModule(torch.nn.Module):
    def forward(self, L_entity_embedding_ : torch.Tensor, L_query_center_embedding_ : torch.Tensor, L_query_offset_embedding_ : torch.Tensor):
        l_entity_embedding_ = L_entity_embedding_
        l_query_center_embedding_ = L_query_center_embedding_
        l_query_offset_embedding_ = L_query_offset_embedding_
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = l_entity_embedding_ - l_query_center_embedding_;  l_entity_embedding_ = l_query_center_embedding_ = None
        delta = sub.abs();  sub = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - l_query_offset_embedding_
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, l_query_offset_embedding_);  delta = l_query_offset_embedding_ = None
        
        # File: /home/caohanghang/gitproject/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        logit = sub_2 - mul;  sub_2 = mul = None
        return (logit,)
        

TRACED GRAPH
 __compiled_fn_17 <eval_with_key>.296 opcode         name                       target                                                  args                                              kwargs
-------------  -------------------------  ------------------------------------------------------  ------------------------------------------------  -------------------
placeholder    l_entity_embedding_        L_entity_embedding_                                     ()                                                {}
placeholder    l_query_center_embedding_  L_query_center_embedding_                               ()                                                {}
placeholder    l_query_offset_embedding_  L_query_offset_embedding_                               ()                                                {}
call_function  sub                        <built-in function sub>                                 (l_entity_embedding_, l_query_center_embedding_)  {}
call_method    delta                      abs                                                     (sub,)                                            {}
call_function  sub_1                      <built-in function sub>                                 (delta, l_query_offset_embedding_)                {}
call_function  distance_out               <function relu at 0x7f90c67555a0>                       (sub_1,)                                          {}
call_function  distance_in                <built-in method min of type object at 0x7f9168185840>  (delta, l_query_offset_embedding_)                {}
get_attr       l__self___gamma            L__self___gamma                                         ()                                                {}
call_function  norm                       <function norm at 0x7f90c655b910>                       (distance_out,)                                   {'p': 1, 'dim': -1}
call_function  sub_2                      <built-in function sub>                                 (l__self___gamma, norm)                           {}
call_function  norm_1                     <function norm at 0x7f90c655b910>                       (distance_in,)                                    {'p': 1, 'dim': -1}
call_function  mul                        <built-in function mul>                                 (0.02, norm_1)                                    {}
call_function  logit                      <built-in function sub>                                 (sub_2, mul)                                      {}
output         output                     output                                                  ((logit,),)                                       {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_17 =====
l_entity_embedding_: (1, 14505, 400)
l_query_center_embedding_: (1, 1, 400)
l_query_offset_embedding_: (1, 1, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
logit: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
